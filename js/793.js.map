{"version":3,"file":"793.js","mappings":"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","sources":["webpack://sakurairo-scripts/./node_modules/promise-worker/register.js","webpack://sakurairo-scripts/webpack/bootstrap","webpack://sakurairo-scripts/webpack/runtime/compat get default export","webpack://sakurairo-scripts/webpack/runtime/define property getters","webpack://sakurairo-scripts/webpack/runtime/hasOwnProperty shorthand","webpack://sakurairo-scripts/./node_modules/palette/dist/index.mjs","webpack://sakurairo-scripts/./src/sakura-app/theme-color/worker.ts"],"sourcesContent":["'use strict'\n\nfunction isPromise (obj) {\n  // via https://unpkg.com/is-promise@2.1.0/index.js\n  return !!obj && (typeof obj === 'object' || typeof obj === 'function') && typeof obj.then === 'function'\n}\n\nfunction registerPromiseWorker (callback) {\n  function postOutgoingMessage (e, messageId, error, result) {\n    function postMessage (msg) {\n      /* istanbul ignore if */\n      if (typeof self.postMessage !== 'function') { // service worker\n        e.ports[0].postMessage(msg)\n      } else { // web worker\n        self.postMessage(msg)\n      }\n    }\n    if (error) {\n      /* istanbul ignore else */\n      if (typeof console !== 'undefined' && 'error' in console) {\n        // This is to make errors easier to debug. I think it's important\n        // enough to just leave here without giving the user an option\n        // to silence it.\n        console.error('Worker caught an error:', error)\n      }\n      postMessage([messageId, {\n        message: error.message\n      }])\n    } else {\n      postMessage([messageId, null, result])\n    }\n  }\n\n  function tryCatchFunc (callback, message) {\n    try {\n      return { res: callback(message) }\n    } catch (e) {\n      return { err: e }\n    }\n  }\n\n  function handleIncomingMessage (e, callback, messageId, message) {\n    var result = tryCatchFunc(callback, message)\n\n    if (result.err) {\n      postOutgoingMessage(e, messageId, result.err)\n    } else if (!isPromise(result.res)) {\n      postOutgoingMessage(e, messageId, null, result.res)\n    } else {\n      result.res.then(function (finalResult) {\n        postOutgoingMessage(e, messageId, null, finalResult)\n      }, function (finalError) {\n        postOutgoingMessage(e, messageId, finalError)\n      })\n    }\n  }\n\n  function onIncomingMessage (e) {\n    var payload = e.data\n    if (!Array.isArray(payload) || payload.length !== 2) {\n      // message doens't match communication format; ignore\n      return\n    }\n    var messageId = payload[0]\n    var message = payload[1]\n\n    if (typeof callback !== 'function') {\n      postOutgoingMessage(e, messageId, new Error(\n        'Please pass a function into register().'))\n    } else {\n      handleIncomingMessage(e, callback, messageId, message)\n    }\n  }\n\n  self.addEventListener('message', onIncomingMessage)\n}\n\nmodule.exports = registerPromiseWorker\n","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","// getDefaultExport function for compatibility with non-harmony modules\n__webpack_require__.n = function(module) {\n\tvar getter = module && module.__esModule ?\n\t\tfunction() { return module['default']; } :\n\t\tfunction() { return module; };\n\t__webpack_require__.d(getter, { a: getter });\n\treturn getter;\n};","// define getter functions for harmony exports\n__webpack_require__.d = function(exports, definition) {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.o = function(obj, prop) { return Object.prototype.hasOwnProperty.call(obj, prop); }","function r(r,t){(null==t||t>r.length)&&(t=r.length);for(var n=0,e=new Array(t);n<t;n++)e[n]=r[n];return e}function t(r){return new Promise(function(t,n){r.addEventListener(\"load\",function(r){t(r)}),r.addEventListener(\"error\",function(r){n(r)})})}function n(r){return a(f,r)}function e(r){return a(l,r)}function a(r,t){var n=t.naturalWidth,e=t.naturalHeight,a=r(n,e);return null==a||a.drawImage(t,0,0,n,e),null==a?void 0:a.getImageData(0,0,n,e)}function o(r,t){return i(f,r,t)}function u(r,t){return i(l,r,t)}function i(r,t,n){var e=t.naturalWidth,a=t.naturalHeight,o=e*a/n;if(o>1){var u=e/Math.sqrt(o),i=a/Math.sqrt(o),f=r(u,i);return null==f||f.drawImage(t,0,0,u,i),null==f?void 0:f.getImageData(0,0,u,i)}var l=r(e,a);return null==l||l.drawImage(t,0,0),null==l?void 0:l.getImageData(0,0,e,a)}function f(r,t){var n=document.createElement(\"canvas\"),e=n.getContext(\"2d\");return n.height=t,n.width=r,e}function l(r,t){return new OffscreenCanvas(r,t).getContext(\"2d\")}function c(r){for(var t=r.data,n=[],e=0;e<t.length;e+=4)n.push(t.slice(e,e+4));return n}function v(r,t){var n=r[0]-t[0],e=r[1]-t[1],a=r[2]-t[2],o=r[3]-t[3];return Math.sqrt(n*n+e*e+a*a+o*o)}function d(r){return r.map(function(r){return r/255})}function h(r){var t,n,e,a,o,u,i=(u=(e=r)[2],(a=e[0])>(o=e[1])?o>u?[a,u]:a>u?[a,o]:[u,o]:o>u?u>a?[o,a]:[o,u]:[u,a]),f=i[0],l=i[1],c=f-l,v=f+l;if(0==c)t=0,n=0;else{if(f==r[0]){var d=60*(r[1]-r[2])/c;t=d<0?d+360:d}else t=f==r[1]?60*(r[2]-r[0])/c+120:60*(r[0]-r[1])/c+240;n=0==v?0:v<=1?c/v:c/(2-v)}return[t,n,v/2,r[3]]}var s=function(t){return void 0===t&&(t=[0,1,2,3]),function(n,e){for(var a,o,u=function(t,n){var e=\"undefined\"!=typeof Symbol&&t[Symbol.iterator]||t[\"@@iterator\"];if(e)return(e=e.call(t)).next.bind(e);if(Array.isArray(t)||(e=function(t,n){if(t){if(\"string\"==typeof t)return r(t,n);var e=Object.prototype.toString.call(t).slice(8,-1);return\"Object\"===e&&t.constructor&&(e=t.constructor.name),\"Map\"===e||\"Set\"===e?Array.from(t):\"Arguments\"===e||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e)?r(t,n):void 0}}(t))){e&&(t=e);var a=0;return function(){return a>=t.length?{done:!0}:{done:!1,value:t[a++]}}}throw new TypeError(\"Invalid attempt to iterate non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\")}(t);!(o=u()).done;){var i=o.value;if(0!=(a=n[i]-e[i]))return a}return a}},g=function(r){return\"hsla(\"+r[0]+\"deg,\"+100*r[1]+\"%,\"+100*r[2]+\"%,\"+r[3]+\")\"},m=function(r){return\"rgba(\"+r.map(function(r){return Math.floor(r)}).join(\",\")+\")\"};function p(r,t,n){for(var e=[],a=[],o=[],u=0,i=0;i<t;i++)e.push(r[Math.floor(Math.random()*r.length)]),o.push(y(0,5));for(;u<n;){for(var f=0;f<r.length;f++){for(var l=r[f],c=0,d=v(l,e[0]),h=1;h<t;h++){var s=v(l,e[h]);s<d&&(d=s,c=h)}var g=o[c];g[0]+=l[0],g[1]+=l[1],g[2]+=l[2],g[3]+=l[3],g[4]++}for(var m=0,p=0;p<t;p++){var w=o[p],I=w[4];a[p]=0==I?r[Math.floor(Math.random()*r.length)]:[w[0]/I,w[1]/I,w[2]/I,w[3]/I],m+=v(e[p],a[p])}if(m<=1)return{cluster_center:a,iterate_time:u,fit_thresold:!0,label:o.map(function(r){return r[4]}),size:r.length};b(a,e),u++;for(var M=0;M<t;M++){var A=o[M];A[0]=0,A[1]=0,A[2]=0,A[3]=0,A[4]=0}}return{cluster_center:e,iterate_time:u,fit_thresold:!1,label:o.map(function(r){return r[4]}),size:r.length}}function b(r,t){for(var n=0;n<r.length;n++)t[n]=r[n]}function y(r,t){for(var n=[],e=0;e<t;e++)n.push(r);return n}export{t as awaitImage,v as euclidean_distance,g as hslaCSSText,p as kmeans,d as normalizeRGBA,n as readImage,e as readImageAsync,o as readImageDownsampling,u as readImageDownsamplingAsync,m as rgbaCSSText,h as rgbaToHSLA,s as sortHSL,c as toPixel};\n//# sourceMappingURL=index.mjs.map\n","import { kmeans, toPixel } from \"palette\";\nimport registerPromiseWorker from 'promise-worker/register';\nregisterPromiseWorker(function (data) {\n    const { img, k, iteration } = data;\n    const result = kmeans(toPixel(img), k, iteration);\n    return result;\n});\n"],"names":["module","exports","callback","postOutgoingMessage","e","messageId","error","result","postMessage","msg","self","ports","console","message","addEventListener","payload","data","Array","isArray","length","Error","obj","res","err","tryCatchFunc","then","finalResult","finalError","handleIncomingMessage","__webpack_module_cache__","__webpack_require__","moduleId","cachedModule","undefined","__webpack_modules__","n","getter","__esModule","d","a","definition","key","o","Object","defineProperty","enumerable","get","prop","prototype","hasOwnProperty","call","v","r","t","Math","sqrt","b","y","push","img","k","iteration","u","i","floor","random","f","l","c","h","s","g","m","p","w","I","cluster_center","iterate_time","fit_thresold","label","map","size","M","A","slice"],"sourceRoot":""}